<div class="container">
    <h1>Método de Newton-Raphson Mejorado</h1>
    <form [formGroup]="form" (ngSubmit)="findRoot()">
        <div>
            <label for="function">Función*</label>
            <input id="function" formControlName="function" placeholder="(!) Las funciones trigonométricas utilizan radianes. Ej. cos(x*pi/180) para cos(x) en grados" />
        </div>
        <div>
            <label for="initialGuess">Aproximación inicial*</label>
            <input id="initialGuess" formControlName="initialGuess" placeholder="ej. 2" />
        </div>
        <div>
            <label for="tolerance">Tolerancia (%)*</label>
            <input id="tolerance" formControlName="tolerance" placeholder="ej. 10" />
        </div>
        <div>
            <label for="maxIterations">Máximo de iteraciones*</label>
            <input id="maxIterations" formControlName="maxIterations" placeholder="ej. 100" />
        </div>
        <div>
            <label for="decimals">Número de decimales para x0 y x1 (<=15)*</label>
            <input id="decimals" formControlName="decimals" placeholder="ej. 10" />
        </div>
        <button type="submit" [disabled]="form.invalid">Encontrar raíz</button>
    </form>
    
    <div *ngIf="errorMessage" class="error-message">
        <p>{{ errorMessage }}</p>
    </div>
    
    <div *ngIf="iterations.length > 0 && !errorMessage">
        <h2>Resultado Final</h2>
        <p><strong>Raíz encontrada:</strong> {{ iterations[iterations.length-1].x1 }}</p>
        <p><strong>Error:</strong> {{ iterations[iterations.length-1].error * 100 }}%</p>
    </div>
    
    <div *ngIf="iterations.length > 0">
        <h2>Iteración {{ currentIterationIndex + 1 }} de {{ iterations.length }}</h2>
        <div class="iteration-info">
            <p><strong>x0:</strong> {{ iterations[currentIterationIndex].x0 }}</p>
            <p><strong>f(x0):</strong> {{ iterations[currentIterationIndex].fx0 }}</p>
            <p><strong>f'(x0):</strong> {{ iterations[currentIterationIndex].fpx0 }}</p>
            <p><strong>f''(x0):</strong> {{ iterations[currentIterationIndex].fppx0 }}</p>
            <p><strong>x1:</strong> {{ iterations[currentIterationIndex].x1 }}</p>
            <p><strong>Error:</strong> {{ iterations[currentIterationIndex].error * 100 }}%</p>
        </div>
        <div class="iteration-controls">
            <button (click)="prevIteration()" [disabled]="currentIterationIndex === 0">Anterior</button>
            <button (click)="nextIteration()" [disabled]="currentIterationIndex === iterations.length - 1">Siguiente</button>
        </div>
        <apx-chart [series]="chartSeries" [chart]="chart" [xaxis]="xaxis" [yaxis]="yaxis" [title]="title"></apx-chart>
    </div>
</div>